<?php
/**
 * Custom responsive icon list widget.
 *
 * @package responsive
 * @since 4.1.3
 */

/**
 * Defines the custom widget class.
 */
if ( ! class_exists( 'Responsive_Icon_List_Widget' ) ) {
	/**
	 * Defines the custom widget class.
	 *
	 * @extends WP_Widget
	 */
	class Responsive_Icon_List_Widget extends WP_Widget {
		/**
		 * Class constructor.
		 */
		public function __construct() {
			$widget_options = array(
				'classname'   => 'responsive_icon_list_widget',
				'description' => __( 'Send visitors to an important page on your website.', 'responsive' ),
			);

			parent::__construct( 'responsive_icon_list_widget', __( 'Responsive Icon List', 'responsive' ), $widget_options );
		}

		/**
		 * Outputs the widget markup.
		 *
		 * @param  string $args     argument options.
		 * @param  string $instance The values of the current widget.
		 */
		public function widget( $args, $instance ) {
			// before and after widget arguments are defined by themes.
			$allowed_html_tags = array(
				'section' => array(
					'id'    => array(),
					'class' => array(),
				),
				'div'     => array(
					'id'    => array(),
					'class' => array(),
				),
				'h2'      => array(
					'id'    => array(),
					'class' => array(),
				),
				'h3'      => array(
					'id'    => array(),
					'class' => array(),
				),
				'h4'      => array(
					'id'    => array(),
					'class' => array(),
				),
				'i'       => array(
					'id'    => array(),
					'class' => array(),
				),
			);

			echo wp_kses( $args['before_widget'], $allowed_html_tags );

			if ( ! empty( $instance['responsive_icon_list_widget_icon'] ) ) {
				echo '<div class="responsive-icon-list-icon"><span  style="font-size:' . esc_attr( $instance['responsive_icon_list_widget_icon_size'] ) . '">&#' . esc_html( $instance['responsive_icon_list_widget_icon'] ) . ';</span></div>';
			}
			?>
			<div class="responsive-icon-list-content">
				<?php
				if ( ! empty( $instance['responsive_icon_list_widget_title'] ) ) {
					echo wp_kses( $args['before_title'], $allowed_html_tags ) .
						esc_html( $instance['responsive_icon_list_widget_title'] ) .
					wp_kses( $args['after_title'], $allowed_html_tags );
				}

				if ( ! empty( $instance['responsive_icon_list_widget_content'] ) ) {
					echo '<p class="responsive-icon-list-description">' .
						esc_html( $instance['responsive_icon_list_widget_content'] ) .
					'</p>';
				}
				?>
			</div>
			<?php
			echo wp_kses( $args['after_widget'], $allowed_html_tags );
		}

		/**
		 * Displays the widget form in the admin dashboard.
		 *
		 * @param  string $instance The current values of the widget.
		 */
		public function form( $instance ) {
			$instance = wp_parse_args(
				(array) $instance,
				array(
					'responsive_icon_list_widget_icon'    => '',
					'responsive_icon_list_widget_icon_size' => '50px',
					'responsive_icon_list_widget_title'   => '',
					'responsive_icon_list_widget_content' => '',
				)
			);

			// Widget admin form.
			?>
			<?php
			$iconlist = array( '', '8986', '8987', '9193', '9194', '9195', '9196', '9197', '9198', '9199', '9200', '9201', '9202', '9203', '9208', '9209', '9210', '9410', '9728', '9729', '9730', '9731', '9732', '9733', '9734', '9735', '9736', '9737', '9738', '9739', '9740', '9741', '9742', '9743', '9744', '9745', '9746', '9747', '9748', '9748', '9749', '9749', '9750', '9751', '9752', '9753', '9754', '9755', '9756', '9757', '9757', '9758', '9759', '9760', '9761', '9762', '9763', '9764', '9765', '9766', '9767', '9768', '9769', '9770', '9771', '9772', '9773', '9774', '9775', '9776', '9777', '9778', '9779', '9780', '9781', '9782', '9783', '9784', '9785', '9786', '9787', '9788', '9789', '9790', '9791', '9792', '9793', '9794', '9795', '9796', '9797', '9798', '9799', '9800', '9800', '9801', '9801', '9802', '9802', '9803', '9803', '9804', '9804', '9805', '9805', '9806', '9806', '9807', '9807', '9808', '9808', '9809', '9809', '9810', '9810', '9811', '9811', '9812', '9813', '9814', '9815', '9816', '9817', '9818', '9819', '9820', '9821', '9822', '9823', '9823', '9824', '9825', '9826', '9827', '9828', '9829', '9830', '9831', '9832', '9833', '9834', '9835', '9836', '9837', '9838', '9839', '9840', '9841', '9842', '9843', '9844', '9845', '9846', '9847', '9848', '9849', '9850', '9851', '9852', '9853', '9854', '9855', '9855', '9856', '9857', '9858', '9859', '9860', '9861', '9862', '9863', '9864', '9865', '9866', '9867', '9868', '9869', '9870', '9871', '9872', '9873', '9874', '9875', '9875', '9876', '9877', '9878', '9879', '9880', '9881', '9882', '9883', '9884', '9885', '9886', '9887', '9888', '9889', '9889', '9890', '9891', '9892', '9893', '9894', '9895', '9896', '9897', '9898', '9898', '9899', '9899', '9900', '9901', '9902', '9903', '9904', '9905', '9906', '9907', '9908', '9909', '9910', '9911', '9912', '9913', '9914', '9915', '9916', '9917', '9917', '9918', '9918', '9919', '9920', '9921', '9922', '9923', '9924', '9924', '9925', '9925', '9926', '9927', '9928', '9929', '9930', '9931', '9932', '9933', '9934', '9934', '9935', '9935', '9936', '9937', '9937', '9938', '9939', '9939', '9940', '9940', '9941', '9942', '9943', '9944', '9945', '9946', '9947', '9948', '9949', '9950', '9951', '9952', '9953', '9954', '9955', '9956', '9957', '9958', '9959', '9960', '9961', '9961', '9962', '9962', '9963', '9964', '9965', '9966', '9967', '9968', '9968', '9969', '9969', '9970', '9970', '9971', '9971', '9972', '9972', '9973', '9973', '9974', '9975', '9975', '9976', '9976', '9977', '9977', '9978', '9978', '9979', '9980', '9981', '9981', '9982', '9983', '9985', '9986', '9986', '9987', '9988', '9989', '9989', '9990', '9991', '9992', '9992', '9993', '9993', '9994', '9994', '9995', '9995', '9996', '9996', '9997', '9997', '9998', '9999', '9999', '10000', '10001', '10002', '10002', '10003', '10004', '10004', '10005', '10006', '10006', '10007', '10008', '10009', '10010', '10011', '10012', '10013', '10013', '10014', '10015', '10016', '10017', '10017', '10018', '10019', '10020', '10021', '10022', '10023', '10024', '10024', '10025', '10026', '10027', '10028', '10029', '10030', '10031', '10032', '10033', '10034', '10035', '10035', '10036', '10036', '10037', '10038', '10039', '10040', '10041', '10042', '10043', '10044', '10045', '10046', '10047', '10048', '10049', '10050', '10051', '10052', '10052', '10053', '10054', '10055', '10055', '10056', '10057', '10058', '10059', '10060', '10060', '10061', '10062', '10062', '10063', '10064', '10065', '10066', '10067', '10067', '10068', '10068', '10069', '10069', '10070', '10071', '10071', '10072', '10073', '10074', '10075', '10076', '10077', '10078', '10079', '10080', '10081', '10082', '10083', '10083', '10084', '10084', '10085', '10086', '10087', '10088', '10089', '10090', '10091', '10092', '10093', '10094', '10095', '10096', '10097', '10098', '10099', '10100', '10101', '10102', '10103', '10104', '10105', '10106', '10107', '10108', '10109', '10110', '10111', '10112', '10113', '10114', '10115', '10116', '10117', '10118', '10119', '10120', '10121', '10122', '10123', '10124', '10125', '10126', '10127', '10128', '10129', '10130', '10131', '10132', '10133', '10133', '10134', '10134', '10135', '10135', '10136', '10137', '10138', '10139', '10140', '10141', '10142', '10143', '10144', '10145', '10145', '10146', '10147', '10148', '10149', '10150', '10151', '10152', '10153', '10154', '10155', '10156', '10157', '10158', '10159', '10160', '10160', '10161', '10162', '10163', '10164', '10165', '10166', '10167', '10168', '10169', '10170', '10171', '10172', '10173', '10174', '10175', '10175', '10548', '10549', '11013', '11014', '11015', '11035', '11036', '11088', '11093', '12336', '12349', '12951', '12953', '126980', '127183', '127344', '127345', '127358', '127359', '127374', '127377', '127378', '127379', '127380', '127381', '127382', '127383', '127384', '127385', '127386', '127489', '127490', '127514', '127535', '127538', '127539', '127540', '127541', '127542', '127543', '127544', '127545', '127546', '127568', '127569', '127744', '127745', '127746', '127747', '127748', '127749', '127750', '127751', '127752', '127753', '127754', '127755', '127756', '127757', '127758', '127759', '127760', '127761', '127762', '127763', '127764', '127765', '127766', '127767', '127768', '127769', '127770', '127771', '127772', '127773', '127774', '127775', '127776', '127777', '127780', '127781', '127782', '127783', '127784', '127785', '127786', '127787', '127788', '127789', '127790', '127791', '127792', '127793', '127794', '127795', '127796', '127797', '127798', '127799', '127800', '127801', '127802', '127803', '127804', '127805', '127806', '127807', '127808', '127809', '127810', '127811', '127812', '127813', '127814', '127815', '127816', '127817', '127818', '127819', '127820', '127821', '127822', '127823', '127824', '127825', '127826', '127827', '127828', '127829', '127830', '127831', '127832', '127833', '127834', '127835', '127836', '127837', '127838', '127839', '127840', '127841', '127842', '127843', '127844', '127845', '127846', '127847', '127848', '127849', '127850', '127851', '127852', '127853', '127854', '127855', '127856', '127857', '127858', '127859', '127860', '127861', '127862', '127863', '127864', '127865', '127866', '127867', '127868', '127869', '127870', '127871', '127872', '127873', '127874', '127875', '127876', '127877', '127878', '127879', '127880', '127881', '127882', '127883', '127884', '127885', '127886', '127887', '127888', '127889', '127890', '127891', '127894', '127895', '127897', '127898', '127899', '127902', '127903', '127904', '127905', '127906', '127907', '127908', '127909', '127910', '127911', '127912', '127913', '127914', '127915', '127916', '127917', '127918', '127919', '127920', '127921', '127922', '127923', '127924', '127925', '127926', '127927', '127928', '127929', '127930', '127931', '127932', '127933', '127934', '127935', '127936', '127937', '127938', '127939', '127940', '127941', '127942', '127943', '127944', '127945', '127946', '127947', '127948', '127949', '127950', '127951', '127952', '127953', '127954', '127955', '127956', '127957', '127958', '127959', '127960', '127961', '127962', '127963', '127964', '127965', '127966', '127967', '127968', '127969', '127970', '127971', '127972', '127973', '127974', '127975', '127976', '127977', '127978', '127979', '127980', '127981', '127982', '127983', '127984', '127987', '127988', '127989', '127991', '127992', '127993', '127994', '127995', '127996', '127997', '127998', '127999', '128000', '128001', '128002', '128003', '128004', '128005', '128006', '128007', '128008', '128009', '128010', '128011', '128012', '128013', '128014', '128015', '128016', '128017', '128018', '128019', '128020', '128021', '128022', '128023', '128024', '128025', '128026', '128027', '128028', '128029', '128030', '128031', '128032', '128033', '128034', '128035', '128036', '128037', '128038', '128039', '128040', '128041', '128042', '128043', '128044', '128045', '128046', '128047', '128048', '128049', '128050', '128051', '128052', '128053', '128054', '128055', '128056', '128057', '128058', '128059', '128060', '128061', '128062', '128063', '128064', '128065', '128066', '128067', '128068', '128069', '128070', '128071', '128072', '128073', '128074', '128075', '128076', '128077', '128078', '128079', '128080', '128081', '128082', '128083', '128084', '128085', '128086', '128087', '128088', '128089', '128090', '128091', '128092', '128093', '128094', '128095', '128096', '128097', '128098', '128099', '128100', '128101', '128102', '128103', '128104', '128105', '128106', '128107', '128108', '128109', '128110', '128111', '128112', '128113', '128114', '128115', '128116', '128117', '128118', '128119', '128120', '128121', '128122', '128123', '128124', '128125', '128126', '128127', '128128', '128129', '128130', '128131', '128132', '128133', '128134', '128135', '128136', '128137', '128138', '128139', '128140', '128141', '128142', '128143', '128144', '128145', '128146', '128147', '128148', '128149', '128150', '128151', '128152', '128153', '128154', '128155', '128156', '128157', '128158', '128159', '128160', '128161', '128162', '128163', '128164', '128165', '128166', '128167', '128168', '128169', '128170', '128171', '128172', '128173', '128174', '128175', '128176', '128177', '128178', '128179', '128180', '128181', '128182', '128183', '128184', '128185', '128186', '128187', '128188', '128189', '128190', '128191', '128192', '128193', '128194', '128195', '128196', '128197', '128198', '128199', '128200', '128201', '128202', '128203', '128204', '128205', '128206', '128207', '128208', '128209', '128210', '128211', '128212', '128213', '128214', '128215', '128216', '128217', '128218', '128219', '128220', '128221', '128222', '128223', '128224', '128225', '128226', '128227', '128228', '128229', '128230', '128231', '128232', '128233', '128234', '128235', '128236', '128237', '128238', '128239', '128240', '128241', '128242', '128243', '128244', '128245', '128246', '128247', '128248', '128249', '128250', '128251', '128252', '128253', '128255', '128256', '128257', '128258', '128259', '128260', '128261', '128262', '128263', '128264', '128265', '128266', '128267', '128268', '128269', '128270', '128271', '128272', '128273', '128274', '128275', '128276', '128277', '128278', '128279', '128280', '128281', '128282', '128283', '128284', '128285', '128286', '128287', '128288', '128289', '128290', '128291', '128292', '128293', '128294', '128295', '128296', '128297', '128298', '128299', '128300', '128301', '128302', '128303', '128304', '128305', '128306', '128307', '128308', '128309', '128310', '128311', '128312', '128313', '128314', '128315', '128316', '128317', '128329', '128330', '128331', '128332', '128333', '128334', '128336', '128337', '128338', '128339', '128340', '128341', '128342', '128343', '128344', '128345', '128346', '128347', '128348', '128349', '128350', '128351', '128352', '128353', '128354', '128355', '128356', '128357', '128358', '128359', '128367', '128368', '128371', '128372', '128373', '128374', '128375', '128376', '128377', '128378', '128391', '128394', '128395', '128396', '128397', '128400', '128405', '128406', '128420', '128421', '128424', '128433', '128434', '128444', '128450', '128451', '128452', '128465', '128466', '128467', '128476', '128477', '128478', '128481', '128483', '128488', '128495', '128499', '128506', '128507', '128508', '128509', '128510', '128511', '128512', '128513', '128514', '128515', '128516', '128517', '128518', '128519', '128520', '128521', '128522', '128523', '128524', '128525', '128526', '128527', '128528', '128529', '128530', '128531', '128532', '128533', '128534', '128535', '128536', '128537', '128538', '128539', '128540', '128541', '128542', '128543', '128544', '128545', '128546', '128547', '128548', '128549', '128550', '128551', '128552', '128553', '128554', '128555', '128556', '128557', '128558', '128559', '128560', '128561', '128562', '128563', '128564', '128565', '128566', '128567', '128568', '128569', '128570', '128571', '128572', '128573', '128574', '128575', '128576', '128577', '128578', '128579', '128580', '128581', '128582', '128583', '128584', '128585', '128586', '128587', '128588', '128589', '128590', '128591', '128640', '128641', '128642', '128643', '128644', '128645', '128646', '128647', '128648', '128649', '128650', '128651', '128652', '128653', '128654', '128655', '128656', '128657', '128658', '128659', '128660', '128661', '128662', '128663', '128664', '128665', '128666', '128667', '128668', '128669', '128670', '128671', '128672', '128673', '128674', '128675', '128676', '128677', '128678', '128679', '128680', '128681', '128682', '128683', '128684', '128685', '128686', '128687', '128688', '128689', '128690', '128691', '128692', '128693', '128694', '128695', '128696', '128697', '128698', '128699', '128700', '128701', '128702', '128703', '128704', '128705', '128706', '128707', '128708', '128709', '128715', '128716', '128717', '128718', '128719', '128720', '128721', '128722', '128736', '128737', '128738', '128739', '128740', '128741', '128745', '128747', '128748', '128752', '128755', '128756', '128757', '128758', '128759', '128760', '128761', '128762', '129296', '129297', '129298', '129299', '129300', '129301', '129302', '129303', '129304', '129305', '129306', '129307', '129308', '129309', '129310', '129311', '129312', '129313', '129314', '129315', '129316', '129317', '129318', '129319', '129320', '129321', '129322', '129323', '129324', '129325', '129326', '129327', '129328', '129329', '129330', '129331', '129332', '129333', '129334', '129335', '129336', '129337', '129338', '129340', '129341', '129342', '129344', '129345', '129346', '129347', '129348', '129349', '129351', '129352', '129353', '129354', '129355', '129356', '129357', '129358', '129359', '129360', '129361', '129362', '129363', '129364', '129365', '129366', '129367', '129368', '129369', '129370', '129371', '129372', '129373', '129374', '129375', '129376', '129377', '129378', '129379', '129380', '129381', '129382', '129383', '129384', '129385', '129386', '129387', '129408', '129409', '129410', '129411', '129412', '129413', '129414', '129415', '129416', '129417', '129418', '129419', '129420', '129421', '129422', '129423', '129424', '129425', '129426', '129427', '129428', '129429', '129430', '129431', '129472', '129488', '129489', '129490', '129491', '129492', '129493', '129494', '129495', '129496', '129497', '129498', '129499', '129500', '129501', '129502', '129503', '129504', '129505', '129506', '129507', '129508', '129509', '129510' );

			?>
			<p style="margin-left:25%;">
				<label for="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_icon' ) ); ?>"><?php esc_html_e( 'Icon:', 'responsive' ); ?></label>
				<select class="icon-selector" name="<?php echo esc_attr( $this->get_field_name( 'responsive_icon_list_widget_icon' ) ); ?>" id="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_icon' ) ); ?>">
					<?php foreach ( $iconlist as $iconlist_value ) { ?>
						<option value="<?php echo esc_attr( $iconlist_value ); ?>" <?php echo ( $iconlist_value == $instance['responsive_icon_list_widget_icon'] ) ? ' selected' : ''; ?>>
							<?php echo esc_html( '&#' . $iconlist_value . ';' ); ?>
						</option>
					<?php } ?>
				</select>
			</p>

			<p>
				<label for="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_icon_size' ) ); ?>"><?php esc_html_e( 'Icon Size (With px,em,rem ):', 'responsive' ); ?></label>
				<input class="widefat" id="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_icon_size' ) ); ?>" name="<?php echo esc_attr( $this->get_field_name( 'responsive_icon_list_widget_icon_size' ) ); ?>" type="text" value="<?php echo esc_attr( $instance['responsive_icon_list_widget_icon_size'] ); ?>" />
			</p>
			<p>
				<label for="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_title' ) ); ?>"><?php esc_html_e( 'Title:', 'responsive' ); ?></label>
				<input class="widefat" id="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_title' ) ); ?>" name="<?php echo esc_attr( $this->get_field_name( 'responsive_icon_list_widget_title' ) ); ?>" type="text" value="<?php echo esc_attr( $instance['responsive_icon_list_widget_title'] ); ?>" />
			</p>

			<p>
				<label for="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_content' ) ); ?>"><?php esc_html_e( 'Content:', 'responsive' ); ?></label>
				<textarea name="<?php echo esc_attr( $this->get_field_name( 'responsive_icon_list_widget_content' ) ); ?>" id="<?php echo esc_attr( $this->get_field_id( 'responsive_icon_list_widget_content' ) ); ?>" rows="4" class="widefat"><?php echo esc_textarea( $instance['responsive_icon_list_widget_content'] ); ?></textarea>
			</p>

			<?php
		}

		/**
		 * Updates the widget.
		 *
		 * @param  string $new_instance The new values of submitted widget.
		 * @param  string $old_instance The old values of the submitted widget.
		 */
		public function update( $new_instance, $old_instance ) {
			return array(
				'responsive_icon_list_widget_icon'      => esc_html( $new_instance['responsive_icon_list_widget_icon'] ),
				'responsive_icon_list_widget_icon_size' => esc_html( $new_instance['responsive_icon_list_widget_icon_size'] ),
				'responsive_icon_list_widget_title'     => esc_html( $new_instance['responsive_icon_list_widget_title'] ),
				'responsive_icon_list_widget_content'   => wp_kses_data( $new_instance['responsive_icon_list_widget_content'] ),
			);
		}
	} // Class funnel_widget ends here
} // If ends.

/**
 * Enqueues widget admin styles & scripts.
 */
if ( ! function_exists( 'responsive_icon_list_widget_admin_scripts' ) ) {
	/**
	 * Enqueues widget admin styles & scripts.
	 *
	 * @return void
	 */
	function responsive_icon_list_widget_admin_scripts() {
		// Enqueue styles & scripts for media uploader.
		wp_enqueue_media();

		// Enqueue responsive icon list widget styles.
		wp_enqueue_style( 'responsive-icon-list-widget-style', get_template_directory_uri() . '/core/includes/widgets/responsive-icon-list-widget.css', '4.1.3', true );
	}

	add_action( 'admin_enqueue_scripts', 'responsive_icon_list_widget_admin_scripts' );
}

/**
 * Registers the responsive icon list widget.
 */
if ( ! function_exists( 'responsive_icon_list_widget_register' ) ) {
	/**
	 * Registers the responsive icon list widget.
	 *
	 * @return void
	 */
	function responsive_icon_list_widget_register() {
		register_widget( 'Responsive_Icon_List_Widget' );
	}

	add_action( 'widgets_init', 'responsive_icon_list_widget_register' );
}
